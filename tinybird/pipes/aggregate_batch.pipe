NODE calc
SQL >

    SELECT
        name as station,
        round(toFloat32(avg(measurement)), 1) as avg_temp,
        round(toFloat32(min(measurement)), 1) as min_temp,
        round(toFloat32(max(measurement)), 1) as max_temp
    FROM measurements_batch
    GROUP BY station
    ORDER BY station

TYPE copy
TARGET_DATASOURCE result_aggregate_batch
COPY_SCHEDULE @on-demand


